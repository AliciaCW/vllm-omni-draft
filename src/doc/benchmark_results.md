结论：
bs=2，seq_len=128的情况下
diffusers baseline 响应速度46.4s, 最大吞吐 154 token/s 
vllm + diffuser only denoising 响应速度39.3s, 最大吞吐 185 token/s

token为结合了text和image的prompt_embeds的token数

**vllm qwen2.5vl + diffusers qwen image edit donot run qwen2.5vl:**

| 配置<br>(bs×seq) | E2ET<br>(s)            |
| ---------------- | ---------------------- |
| 2×128            | 0.580 + 38.7 = 39.28   |
| 2×512            | 0.321  + 40.3 = 40.621 |
| 4×128 (n=2)      | 0.320 + 75.3 = 75.62   |
| 4×512 (n=2)      | 0.317 +  79.7 = 80.017 |

**vllm qwen2.5vl**
| 配置<br>(bs×seq) | E2ET<br>(s) | TPOT<br>(s) | QwenVL-output<br>吞吐/s | QwenVL-output<br>per prompt | PeakMem<br>(MB) |
| ---------------- | ----------- | ----------- | ----------------------- | --------------------------- | --------------- |
| 2×128            | 0.580       | 0.0187      | 12 360                  | 6 180                       | 69.9k           |
| 2×256            | 0.314       | 0.0101      | 22 890                  | 11 445                      | 69.9k           |
| 2×512            | 0.321       | 0.0103      | 22 310                  | 11 155                      | 69.9k           |
| 4×128            | 0.320       | 0.0103      | 44 760                  | 11 190                      | 69.9k           |
| 4×256            | 0.317       | 0.0102      | 45 420                  | 11 355                      | 69.9k           |
| 4×512            | 0.317       | 0.0102      | 45 330                  | 11 332                      | 69.9k           |
| 8×128            | 0.354       | 0.0114      | 80 984                  | 10 123                      | 69.9k           |
| 8×256            | 0.357       | 0.0115      | 80 267                  | 10 033                      | 69.9k           |
| 8×512            | 0.351       | 0.0113      | 81 706                  | 10 213                      | 69.9k           |

**diffusers qwen image edit donot run qwen2.5vl**
| 配置<br>(bs×seq) | 平均 E2ET<br>(s) | 吞吐<br>(images/s) | 单 prompt 吞吐<br>(images/s) | Transformer Throughput<br>(tokens/s) | 峰值显存<br>(MB) |
| ---------------- | ---------------- | ------------------ | ---------------------------- | ------------------------------------ | ---------------- |
| 2×128 (n=4)      | 38.7             | 0.051              | 0.026                        | 185                                  | 63.6 k           |
| 2×512 (n=4)      | 40.3             | 0.049              | 0.025                        | 177                                  | 63.6 k           |
| 4×128 (n=2)      | 75.3             | 0.053              | 0.013                        | 190                                  | 72.2 k           |
| 4×512 (n=2)      | 79.7             | 0.050              | 0.013                        | 180                                  | 72.2 k           |


diffusers qwen image baseline

| 配置<br>(bs×seq) | 平均 E2ET<br>(s) | 吞吐<br>(images/s) | 单 prompt 吞吐<br>(images/s) | Transformer Throughput<br>(tokens/s) | 峰值显存<br>(MB) |
| ---------------- | ---------------- | ------------------ | ---------------------------- | ------------------------------------ | ---------------- |
| 2×128 (n=4)      | 46.4             | 0.043              | 0.021                        | 154                                  | 63.6 k           |
| 2×512 (n=4)      | 48.7             | 0.041              | 0.020                        | 147                                  | 63.6 k           |
| 4×128 (n=2)      | 91.4             | 0.044              | 0.011                        | 157                                  | 72.2 k           |
| 4×512 (n=2)      | 95.9             | 0.042              | 0.010                        | 149                                  | 72.2 k           |

